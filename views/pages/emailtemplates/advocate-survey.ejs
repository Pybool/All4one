<!DOCTYPE html>
<html>
<head>
  <style>
    body { font-family: Arial, sans-serif; font-size: 13px; }
    h2 { color: #283078; border-bottom: 1px solid #ccc; padding-bottom: 4px; }
    table { width: 100%; border-collapse: collapse; margin: 10px 0; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    th { background-color: #e0e0e0; }
  </style>
</head>
<body>
  <h1 style="text-align:center;">Advocate Survey</h1>

  <h2>Survey Information</h2>
  <table>
    <tr><td>Date</td><td><%= data.date || 'N/A' %></td></tr>
    <tr><td>Requested Due Date</td><td><%= data.requestedDueDate || 'N/A' %></td></tr>
    <tr><td>Name</td><td><%= data.name || 'N/A' %></td></tr>
    <tr><td>Relationship to User</td><td><%= data.relationshipToUser || 'N/A' %></td></tr>
  </table>

  <% const renderSection = (title, section) => { %>
    <h2><%= title %></h2>
    <table>
      <% Object.entries(section).forEach(([k,v]) => { %>
        <tr>
          <td><%= k.replace(/([A-Z])/g, ' $1').replace(/^./, c => c.toUpperCase()) %></td>
          <td><%= v %></td>
        </tr>
      <% }) %>
    </table>
  <% } %>

  <% renderSection('Is Service Safe?', data.isServiceSafe) %>
  <% renderSection('Is Service Effective?', data.isServiceEffective) %>
  <% renderSection('Is Service Caring?', data.isServiceCaring) %>
  <% renderSection('Is Service Responsive?', data.isServiceResponsive) %>
  <% renderSection('Is Service Well Led?', data.isServiceWellLed) %>

  <h2>Other Details</h2>
  <table>
    <tr><td>Member of Staff Helped</td><td><%= data.memberOfStaffHelped %></td></tr>
    <tr><td>Told Can Return Anonymously</td><td><%= data.toldCanReturnAnonymously %></td></tr>
    <tr><td>Shown How To Return Anonymously</td><td><%= data.shownHowToReturnAnonymously %></td></tr>
    <tr><td>Satisfied Can Return Anonymously</td><td><%= data.satisfiedCanReturnAnonymously %></td></tr>
    <tr><td>Comments</td><td><%= data.comments || '' %></td></tr>
    <tr><td>Staff Signature</td><td><%= data.staffSignature || '' %></td></tr>
    <tr><td>Staff Print Name</td><td><%= data.staffPrintName || '' %></td></tr>
    <tr><td>Date Returned</td><td><%= data.dateReturned || '' %></td></tr>
    <tr><td>Total Score</td><td><%= data.totalScore || '' %></td></tr>
    <tr><td>Tallied By</td><td><%= data.talliedBy || '' %></td></tr>
    <tr><td>Notes</td><td><%= data.notes || '' %></td></tr>
  </table>

  <h2>Metadata</h2>
  <table>
    <tr><td>Survey ID</td><td><%= payload._id %></td></tr>
    <tr><td>Created At</td><td><%= new Date(payload.createdAt).toDateString() %></td></tr>
    <tr><td>Updated At</td><td><%= new Date(payload.updatedAt).toDateString() %></td></tr>
  </table>

  <p style="font-size:12px;color:#777;text-align:center;">
    This document was auto-generated. Signature not required.
  </p>
</body>
</html>
